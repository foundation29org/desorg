<div class="row">
    <div class="col-md-12 center-elements mt-3" *ngIf="!loadedData">
        <i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>
      </div>
	<div class="col-lg-12 col-12" *ngIf="loadedData">
		<div class="card">
			<div class="card-header">
				<h4 class="card-title">{{'do.questionnaires' | translate }}
					<span class="font-small-3 text-muted float-right">
						<span class="btn btn-outline-primary mr-1" style="text-transform: initial;" (click)="addForm(contentModalForm)">New</span>
						<span class="btn btn-outline-primary ml-1" style="text-transform: initial;" (click)="searchForm(contentModalSearch)">Search</span>
					</span>
					<span class="d-block">
						<span *ngFor="let questionnaire of questionnaires ; let i = index" class="font-small-3 text-muted">
							<span class="d-block">{{questionnaire.id}} <span class="fa fa-edit primary mr-1 ml-1 pointer" (click)="editForm(questionnaire, contentModalForm)"></span><span class="fa fa-trash primary pointer" (click)="deleteForm(questionnaire)"></span></span>
							<!--<span *ngIf="questionnaires.length>0 && (i>0) && (i<=questionnaires.length-1)">,</span>-->
						</span>
					</span>
				</h4>
			</div>
		</div>
	</div>
	<div class="col-lg-12 col-12" *ngIf="loadedData">
		<div class="card">
			<div class="card-header">
				<h5 class="card-title">Answers</h5>
			</div>
			<div class="card-body table-responsive" *ngIf="data.length >0">
				<table class="table text-center">
					<thead>
						<tr>
							<th>Questionaire</th>
							<th>Patient</th>
							<th>Date</th>
							<th style="width: 50%;">Info</th>
						</tr>
					</thead>
					<tbody>
						<tr *ngFor="let element of data ; let i = index">
							<td>{{element.resource.id}}</td>
							<td>{{element.resource.subject.display}}</td>
							<td>{{element.resource.authored|date}}</td>
							<td>
								<p *ngFor="let item of element.resource.item ; let j = index">
									<span class="d-block"><strong>{{item.text}}</strong></span>
									{{item.answer[0].valueString}}
								</p>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
			<div class="card-body" *ngIf="data.length == 0">
				No data
			</div>
		</div>
	</div>

</div>

<ng-template #contentModalForm let-c="close" let-d="dismiss" appendTo="body">
	<div class="modal-header d-block" id="idHeader">
	  <button type="button" class="close" aria-label="Close" (click)="closeModal()">
		<span aria-hidden="true">&times;</span>
	  </button>
	  <div>
		<h4 class="mb-0">
			Questionnaire
			<span class="font-small-3 mute d-block text-break">{{actualQuestionnaire.title}}</span>
		</h4>
	  </div>
	</div>
	  <div class="content-wrapper" *ngIf="!showPanelNew">
		<fieldset>
			<div class="row mt-3">
			  <div class="col-md-12">
				<div class="form-group">
				  <label for="title">Title</label>
				  <input type="text" id="title" class="form-control"  name="title" [(ngModel)]="actualQuestionnaire.title" required #title="ngModel">
				  <small class="form-text title-muted danger" *ngIf="!title.valid && (title.dirty || title.touched)">{{'generics.required' | translate }}</small>
				</div>
			  </div>
			</div>
		  </fieldset>
		<div class="row col-md-12">
		  <div class="col-md-12">
			<section>
			  <div class="mt-2">
				<p *ngFor="let element of actualQuestionnaire.items ; let i = index">
					{{element.idProm}}. {{element.text}}
					<span class="d-block">
						<strong>Answers:</strong> <span *ngFor="let answer of element.answers ; let j = index">{{answer.text}} <span *ngIf="element.answers.length>0 && (i>0) && (i<=element.answers.length-1)">,</span></span>
					</span>
				</p>
			  </div>
			</section>
		  </div>
		</div>
		<div class="row">
			<div class="col-sm-12">
			  <div class="form-group">
				<a (click)="newQuestion()" class="btn btn-outline-primary" href="javascript:void(0)"><i class="fa fa-plus"></i> New Question</a>
			  </div>
			</div>
		  </div>
		  <div class="row">
			<div class="col-sm-12">
			  <div class="form-group center-elements">
				<button class="btn btn-raised btn-raised btn-primary" (click)="saveQuestionnaire()"><i class="fa fa-check-square-o"></i> {{'generics.Save' | translate }}</button>
			  </div>
			</div>
		  </div>
	</div>
	<div class="content-wrapper" *ngIf="showPanelNew">
		<form class="form" (ngSubmit)="onSubmitNew()" #f="ngForm">
			<fieldset>
				<div class="row mt-3">
				  <div class="col-md-12">
					<div class="form-group">
					  <label for="text">Question</label>
					  <input type="text" id="text" class="form-control"  name="text" [(ngModel)]="changeQuestion.text" required #text="ngModel">
					  <small class="form-text text-muted danger" *ngIf="!text.valid && (text.dirty || text.touched)">{{'generics.required' | translate }}</small>
					</div>
				  </div>
				</div>
			  </fieldset>
			<fieldset>
			  <div class="row">
				<div class="col-md-12">
				  <div class="form-group" *ngFor="let question of changeQuestion.answers ; let i=index">
					<label for="shortDescription2">Answer {{i+1}}</label>
					<span *ngIf="i!=0">
					  <a class="btn btn-outline-danger mb-1 float-right" (click)="deleteAltQuestion(i)" href="javascript:void(0)"><i class="fa fa-times"></i></a>
					</span>
					<input type="text" id="question.text{{i}}" class="form-control"  name="question.text{{i}}" [(ngModel)]="question.text" required #text="ngModel">
				  </div>
				</div>
			  </div>
			</fieldset>
			<div class="form-group">
				<a (click)="addQuestion()" class="btn btn-outline-primary" href="javascript:void(0)"><i class="fa fa-plus"></i> Add Answer</a>
			  </div>
			
			<div class="center-elements">
			  <button type="button" (click)="cancelNewQnaPair()" class="btn btn-raised btn-raised btn-warning mr-1">
				<i class="ft-x"></i> {{'generics.Cancel' | translate }}
			  </button>
			  <div *ngIf="f.valid;then formValid else formError"></div>
							  <ng-template #formValid><button class="btn btn-raised btn-raised btn-primary" type="submit"><i class="fa fa-check-square-o"></i> {{'generics.Save' | translate }}</button></ng-template>
							  <ng-template #formError><button class="btn btn-raised btn-raised btn-primary" type="button" (click)="submitInvalidForm()"><i class="fa fa-check-square-o"></i> {{'generics.Save' | translate }}</button></ng-template>
			</div>
		  </form>
	</div>
	<!--<div class="modal-footer">
	  <div class="col-md-12 center-elements">
		<div class="form-actions center">
		  <button *ngIf="maxStep>='5.0'" type="button" class="mt-2 mr-3 btn secondary btn-outline-secondary" (click)="cancelAnalysis()"><span style="margin-right: 10px;"></span> {{'generics.Cancel' | translate }}</button>
		  <button *ngIf="maxStep<'5.0'" type="button" class="mt-2 mr-3 btn secondary btn-outline-secondary" (click)="goPrevStep()"><span style="margin-right: 10px;"></span> {{'generics.Cancel' | translate }}</button>
		</div>
	  </div>
	</div>-->
  
  </ng-template>

  <ng-template #contentModalSearch let-c="close" let-d="dismiss" appendTo="body">
	<div class="modal-header d-block" id="idHeader">
	  <button type="button" class="close" aria-label="Close" (click)="closeModal()">
		<span aria-hidden="true">&times;</span>
	  </button>
	  <div>
		<h4 class="mb-0">
			Questionnaires store
		</h4>
	  </div>
	</div>
	<div class="content-wrapper" >
		<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
<div class="container">
    <div class="row mt-3">
        <!-- Product-->
        <div class="col-lg-4 col-sm-6 mb-30">
            <div class="product-card mx-auto mb-3">
                <div class="product-head text-right">
                    <div class="rating-stars"><i class="fa fa-star active"></i><i class="fa fa-star active"></i><i class="fa fa-star active"></i><i class="fa fa-star"></i>
                    </div>
                </div>
                <a class="product-thumb" href="#"><img src="https://foundation29.org/wp-content/uploads/2021/05/Logo.png" alt="Product Thumbnail"></a>
                <div class="product-card-body"><a class="product-meta" href="#">Foundation29</a>
                    <h5 class="product-title">General questions of Dravet syndrome</h5><span class="product-price">
                    Free</span>
                </div>
                <div class="product-buttons-wrap">
                    <div class="product-buttons">
                        <div class="product-button"><a href="#"  ><i class="fa fa-heart"></i></a></div>
                        <div class="product-button"><a href="#" ><i class="fa fa-trash"></i></a></div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Product-->
        <div class="col-lg-4 col-sm-6 mb-30">
            <div class="product-card mx-auto mb-5">
                <div class="product-head d-flex justify-content-between align-items-center"><span class="badge badge-success">Popular</span>
                    <div class="rating-stars"><i class="fa fa-star active"></i><i class="fa fa-star active"></i><i class="fa fa-star active"></i><i class="fa fa-star active"></i><i class="fa fa-star active"></i>
                    </div>
                </div>
                <a class="product-thumb" href="#"><img src="https://dravet.eu/wp-content/uploads/2020/04/logo-Dravet-europa-217x230-1.png" alt="Product Thumbnail"></a>
                <div class="product-card-body"><a class="product-meta" href="#">Dravet Syndrome European Federation</a>
                    <h5 class="product-title">Demographic questionnaire</h5><span class="product-price">Free</span>
                </div>
                <div class="product-buttons-wrap">
                    <div class="product-buttons">
                        <div class="product-button"><a href="#"  ><i class="fa fa-heart"></i></a></div>
                        <div class="product-button"><a href="#" ><i class="fa fa-trash"></i></a></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.10.0/feather.js"></script>
	</div>
	<!--<div class="modal-footer">
	  <div class="col-md-12 center-elements">
		<div class="form-actions center">
		  <button *ngIf="maxStep>='5.0'" type="button" class="mt-2 mr-3 btn secondary btn-outline-secondary" (click)="cancelAnalysis()"><span style="margin-right: 10px;"></span> {{'generics.Cancel' | translate }}</button>
		  <button *ngIf="maxStep<'5.0'" type="button" class="mt-2 mr-3 btn secondary btn-outline-secondary" (click)="goPrevStep()"><span style="margin-right: 10px;"></span> {{'generics.Cancel' | translate }}</button>
		</div>
	  </div>
	</div>-->
  
  </ng-template>